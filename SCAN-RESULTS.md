# Vulnerability Scan Results

**Scan Date:** January 8, 2026
**Scanner:** Trivy v0.68
**Total Images Scanned:** 5

---

## üìä Summary

| Service | Image Size | Critical | High | Medium | Total |
|---------|-----------|----------|------|--------|-------|
| **API Service** (Python) | 534 MB | 0 | 89 | 351 | **440** |
| **Frontend Service** (Node.js) | 209 MB | 1 | 23 | 45 | **69** |
| **Worker Service** (Java) | 391 MB | 0 | 0 | 11 | **11** |
| **Nginx** | 36 MB | 2 | 18 | 44 | **64** |
| **Postgres** | - | 0 | 0 | 11 | **11** |
| **TOTAL** | | **3** | **130** | **462** | **595** |

---

## üî¥ Critical Vulnerabilities

### Frontend Service
- **zlib** (CVE-2022-37434): Heap-based buffer over-read and overflow
- **pcre2** (CVE-2022-1586): Out-of-bounds read

### Nginx
- **pcre2** (CVE-2022-1586): Out-of-bounds read
- **zlib** (CVE-2022-37434): Heap-based buffer overflow

---

## üü† High Severity Highlights

### API Service (Python) - 89 High Vulnerabilities
**Key Issues:**
- **urllib3** vulnerabilities (multiple CVEs)
- OS-level package vulnerabilities in Debian base
- Python stdlib issues

### Frontend Service (Node.js) - 23 High Vulnerabilities
**Key NPM Package Issues:**

#### axios@0.21.1 (3 HIGH vulnerabilities)
- CVE-2021-3749: Regular expression DoS
- CVE-2025-27152: SSRF and Credential Leakage
- CVE-2025-58754: DoS via lack of data size check

#### jsonwebtoken@8.5.1 (2 HIGH, 2 MEDIUM)
- CVE-2022-23539: Unrestricted key type
- CVE-2022-23540: Insecure default algorithm
- CVE-2022-23541: Forgeable Public/Private Tokens

#### lodash@4.17.20 (1 HIGH, 1 MEDIUM)
- CVE-2021-23337: Command injection via template
- CVE-2020-28500: ReDoS via trim functions

#### Other High Vulnerabilities:
- **semver**: Regular expression DoS (CVE-2022-25883)
- **path-to-regexp**: ReDoS via backtracking (CVE-2024-45296)

### Nginx - 18 High Vulnerabilities
- Alpine Linux OS package vulnerabilities
- **libxml2**, **pcre2**, **sqlite** issues

---

## üü° Medium Severity Summary

- **API Service**: 351 medium vulnerabilities primarily in OS packages
- **Frontend Service**: 45 medium vulnerabilities in npm dependencies
- **Worker Service**: 11 medium vulnerabilities in Java dependencies
- **Nginx**: 44 medium vulnerabilities in Alpine packages
- **Postgres**: 11 medium vulnerabilities in Debian packages

---

## üí° Remediation Recommendations

### Immediate Actions (Critical/High)

1. **Frontend Service NPM Packages:**
   ```bash
   npm install axios@latest        # 0.21.1 ‚Üí 1.7.x
   npm install lodash@latest       # 4.17.20 ‚Üí 4.17.21
   npm install jsonwebtoken@latest # 8.5.1 ‚Üí 9.0.x
   npm install semver@latest       # 5.7.1 ‚Üí 7.6.x
   ```

2. **Update Base Images:**
   - Python: `python:3.9-slim` ‚Üí `python:3.12-slim` or Chainguard
   - Node: `node:14-alpine` ‚Üí `node:20-alpine` or Chainguard
   - Nginx: `nginx:1.21-alpine` ‚Üí `nginx:1.27-alpine` or Chainguard

3. **Java Dependencies (Worker Service):**
   - Consider updating Log4j if present
   - Update Jackson libraries
   - Update PostgreSQL driver

### Long-term Strategy

1. **Adopt Chainguard Images:**
   - Minimal attack surface (10-100x fewer vulnerabilities)
   - No CVEs in most cases
   - Regularly updated

2. **Implement Dependency Scanning in CI/CD:**
   - Add Trivy to GitHub Actions/GitLab CI
   - Block merges with Critical/High vulnerabilities
   - Automated SBOM generation

3. **Regular Updates:**
   - Weekly dependency updates
   - Monthly base image updates
   - Automated Dependabot/Renovate Bot

---

## üìÅ Detailed Reports

Full scan reports available in `./reports/`:
- `vuln-demo_api-service_latest_scan.{json,txt}`
- `vuln-demo_frontend-service_latest_scan.{json,txt}`
- `vuln-demo_worker-service_latest_scan.{json,txt}`
- `vuln-demo_nginx_latest_scan.{json,txt}`
- `postgres_13_scan.{json,txt}`

---

## üéØ Next Steps

1. ‚úÖ Vulnerabilities identified and documented
2. ‚è≠Ô∏è Upgrade vulnerable dependencies
3. ‚è≠Ô∏è Migrate to Chainguard images
4. ‚è≠Ô∏è Re-scan and compare results
5. ‚è≠Ô∏è Deploy to Kubernetes
6. ‚è≠Ô∏è Set up continuous monitoring

---

*Generated by Trivy vulnerability scanner*
